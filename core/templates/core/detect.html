{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Detection & Classification | NeuroVista</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --ink:#0b1b2e;
      --text:#e6f0ff;
      --muted:#9fb7d7;
      --accent:#3aa0ff;
      --glass: rgba(14,34,58,.42);
      --glass-border: rgba(255,255,255,.18);
    }
    html,body{ height:100%; margin:0; }
    body{
      background: radial-gradient(1200px 800px at 75% 40%, #112b46 0%, var(--ink) 60%) fixed;
      color: var(--text);
      font-family: 'Open Sans', sans-serif;
    }
    .bg-brain::before{
      content:""; position:fixed; inset:0; z-index:-1;
      background:
        linear-gradient(90deg, rgba(11,27,46,.92) 0%, rgba(11,27,46,.82) 40%, rgba(11,27,46,.2) 75%, rgba(11,27,46,0) 100%),
        url("{% static 'img/brain_bg.jpg' %}") right center / cover no-repeat;
    }
    .nv-shell{ min-height:100dvh; padding: 36px 16px; }
    .nv-card{
      background: var(--glass);
      backdrop-filter: blur(8px);
      border: 1px solid var(--glass-border);
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      padding: clamp(20px, 3vw, 28px);
    }
    .nv-title{ font-family: 'Montserrat', sans-serif; font-weight:700; letter-spacing:.5px; margin:0; }
    .nv-subtle{ color: var(--muted); }
    .btn-nv{ border-radius:12px !important; padding:12px 16px !important; font-weight:700; }
    .btn-nv-primary{ background: var(--accent); border:1px solid var(--accent); color:#061320; box-shadow: 0 6px 18px rgba(58,160,255,.22); }
    .btn-nv-ghost{ color: var(--text); border:1px solid rgba(255,255,255,.35); background: transparent; }
    .btn-nv-ghost:hover{ background: rgba(255,255,255,.08); border-color: rgba(255,255,255,.55); }
  </style>
</head>
<body class="bg-brain">

<div class="nv-shell container">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h2 class="nv-title">üß†Tumor Detection & Classification</h2>
    <a href="{% url 'home' %}" class="btn btn-nv btn-nv-ghost">‚Üê Home</a>
  </div>
  <p class="nv-subtle mb-4">Initial MRI analysis for {{ patient.name }}.</p>

  <div class="row g-4">
    <!-- LEFT: Details -->
    <div class="col-lg-5">
      <div class="nv-card h-100">
        <h5 class="mb-3">Patient Information</h5>
        <p><strong>Name:</strong> {{ patient.name }}</p>
        <p><strong>Age:</strong> {{ patient.age }}</p>
        <p><strong>Gender:</strong> {{ patient.gender }}</p>

        <hr class="border-light">

        <h5 class="mb-2">Detection Result</h5>
        {% if patient.detected == "yes" %}
          <div class="fs-5 text-success">Tumor Detected ‚úÖ</div>
        {% else %}
          <div class="fs-5 text-danger">No Tumor Detected ‚ùå</div>
        {% endif %}

        {% if classification %}
          <div class="mt-3">
            <h5>Classification</h5>
            <div class="fs-5 text-info">{{ classification|capfirst }}</div>
          </div>
          <a href="{% url 'segment' patient.pk %}" class="btn btn-nv btn-nv-primary mt-4 w-100">‚Üí Proceed to Segmentation</a>
        {% else %}
          <a href="{% url 'register' %}" class="btn btn-nv btn-nv-ghost mt-4 w-100">‚Üê Back to Registration</a>
        {% endif %}
      </div>
    </div>

    <!-- RIGHT: MRI Preview -->
    <div class="col-lg-7">
      <div class="nv-card h-100">
        <h5 class="mb-3">MRI Preview</h5>
        <div class="ratio ratio-4x3 rounded-3" style="overflow:hidden; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04);">
          <img src="{{ patient.mri_image.url }}" alt="MRI" style="width:100%; height:100%; object-fit:contain;">
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
